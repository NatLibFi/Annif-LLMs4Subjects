schema: '2.0'
stages:
  train-xtransformer@tib-core-en:
    cmd:
    - annif train -p projects-xtransformer.toml -j 32 gnd-tib-core-xtransformer-en
      shared-task-datasets/TIBKAT/tib-core-subjects/data/train/en.tsv.gz
    deps:
    - path: data/vocabs/gnd-tib-core
      hash: md5
      md5: 2c649e0e5842585f10bcb060a14a3ca8.dir
      size: 31870479
      nfiles: 3
    - path: shared-task-datasets/TIBKAT/tib-core-subjects/data/train/en.tsv.gz
      hash: md5
      md5: 6a8d0d989b1d9e2e5176becb6ed2f56e
      size: 19213009
    params:
      projects-xtransformer.toml:
        gnd-tib-core-xtransformer-en:
          name: GND-tib-core XTransformer English
          language: en
          backend: xtransformer
          analyzer: snowball(english)
          vocab: gnd-tib-core
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 400
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: data/projects/gnd-tib-core-xtransformer-en
      hash: md5
      md5: b87eec2e96ee2dc40b3729f1262d2630.dir
      size: 1230471627
      nfiles: 25
  train-xtransformer@tib-core-de:
    cmd:
    - annif train -p projects-xtransformer.toml -j 32 gnd-tib-core-xtransformer-de
      shared-task-datasets/TIBKAT/tib-core-subjects/data/train/de.tsv.gz
    deps:
    - path: data/vocabs/gnd-tib-core
      hash: md5
      md5: 2c649e0e5842585f10bcb060a14a3ca8.dir
      size: 31870479
      nfiles: 3
    - path: shared-task-datasets/TIBKAT/tib-core-subjects/data/train/de.tsv.gz
      hash: md5
      md5: 3f4d8a7c3f15e98bf433c6eef0f5295c
      size: 21140795
    params:
      projects-xtransformer.toml:
        gnd-tib-core-xtransformer-de:
          name: GND-tib-core XTransformer German
          language: de
          backend: xtransformer
          analyzer: snowball(german)
          vocab: gnd-tib-core
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 400
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: data/projects/gnd-tib-core-xtransformer-de
      hash: md5
      md5: 513b38363c4c90a7d46b356696dad419.dir
      size: 1254711870
      nfiles: 25
  train-xtransformer@all-de:
    cmd:
    - annif train -p projects-xtransformer.toml -j 32 gnd-all-xtransformer-de shared-task-datasets/TIBKAT/all-subjects/data/train/de.tsv.gz
    deps:
    - path: data/vocabs/gnd-all
      hash: md5
      md5: 1cbcfe7e8b91f19b3a72a5c0942862e7.dir
      size: 85564111
      nfiles: 3
    - path: shared-task-datasets/TIBKAT/all-subjects/data/train/de.tsv.gz
      hash: md5
      md5: 4e1a80f1e539d8e19073e004b752ead0
      size: 39773295
    params:
      projects-xtransformer.toml:
        gnd-all-xtransformer-de:
          name: GND-all XTransformer German
          language: de
          backend: xtransformer
          analyzer: snowball(german)
          vocab: gnd-all
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 400
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: data/projects/gnd-all-xtransformer-de
      hash: md5
      md5: 5c4fac7115baafd589f4716332958946.dir
      size: 1372382050
      nfiles: 28
  train-xtransformer@all-en:
    cmd:
    - annif train -p projects-xtransformer.toml -j 32 gnd-all-xtransformer-en shared-task-datasets/TIBKAT/all-subjects/data/train/en.tsv.gz
    deps:
    - path: data/vocabs/gnd-all
      hash: md5
      md5: 1cbcfe7e8b91f19b3a72a5c0942862e7.dir
      size: 85564111
      nfiles: 3
    - path: shared-task-datasets/TIBKAT/all-subjects/data/train/en.tsv.gz
      hash: md5
      md5: 6444ce7a501bb62bcb9c7dded5722a87
      size: 36341593
    params:
      projects-xtransformer.toml:
        gnd-all-xtransformer-en:
          name: GND-all XTransformer English
          language: en
          backend: xtransformer
          analyzer: snowball(english)
          vocab: gnd-all
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 400
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: data/projects/gnd-all-xtransformer-en
      hash: md5
      md5: 775dc64bdff3d0a249fe579f8aacea88.dir
      size: 1328076340
      nfiles: 28
  eval@all-xtransformer-en:
    cmd:
    - annif eval -p projects-xtransformer.toml gnd-all-xtransformer-en -j 1 -m F1@5
      -m NDCG --metrics-file reports/all-xtransformer-en.json shared-task-datasets/TIBKAT/all-subjects/data/dev/en.tsv.gz
    deps:
    - path: data/projects/gnd-all-xtransformer-en
      hash: md5
      md5: 775dc64bdff3d0a249fe579f8aacea88.dir
      size: 1328076340
      nfiles: 28
    - path: shared-task-datasets/TIBKAT/all-subjects/data/dev/en.tsv.gz
      hash: md5
      md5: cef663a3e160cba1eb960b5bbdf814bb
      size: 6045278
    params:
      projects-xtransformer.toml:
        gnd-all-xtransformer-en:
          name: GND-all XTransformer English
          language: en
          backend: xtransformer
          analyzer: snowball(english)
          vocab: gnd-all
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 400
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: reports/all-xtransformer-en.json
      hash: md5
      md5: 9b7314e4ac5feff74c479f042090d0b7
      size: 94
  eval@tib-core-xtransformer-de:
    cmd:
    - annif eval -p projects-xtransformer.toml gnd-tib-core-xtransformer-de -j 1 -m
      F1@5 -m NDCG --metrics-file reports/tib-core-xtransformer-de.json shared-task-datasets/TIBKAT/tib-core-subjects/data/dev/de.tsv.gz
    deps:
    - path: data/projects/gnd-tib-core-xtransformer-de
      hash: md5
      md5: 513b38363c4c90a7d46b356696dad419.dir
      size: 1254711870
      nfiles: 25
    - path: shared-task-datasets/TIBKAT/tib-core-subjects/data/dev/de.tsv.gz
      hash: md5
      md5: 13bb3e235bf06cc40152b2d74a6cab52
      size: 3494814
    params:
      projects-xtransformer.toml:
        gnd-tib-core-xtransformer-de:
          name: GND-tib-core XTransformer German
          language: de
          backend: xtransformer
          analyzer: snowball(german)
          vocab: gnd-tib-core
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 400
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: reports/tib-core-xtransformer-de.json
      hash: md5
      md5: 1dc3a65d582897adb230c9bab6c36606
      size: 94
  eval@all-xtransformer-de:
    cmd:
    - annif eval -p projects-xtransformer.toml gnd-all-xtransformer-de -j 1 -m F1@5
      -m NDCG --metrics-file reports/all-xtransformer-de.json shared-task-datasets/TIBKAT/all-subjects/data/dev/de.tsv.gz
    deps:
    - path: data/projects/gnd-all-xtransformer-de
      hash: md5
      md5: 5c4fac7115baafd589f4716332958946.dir
      size: 1372382050
      nfiles: 28
    - path: shared-task-datasets/TIBKAT/all-subjects/data/dev/de.tsv.gz
      hash: md5
      md5: 06f918e93fbd03fcb62e2e160eca06ba
      size: 6626372
    params:
      projects-xtransformer.toml:
        gnd-all-xtransformer-de:
          name: GND-all XTransformer German
          language: de
          backend: xtransformer
          analyzer: snowball(german)
          vocab: gnd-all
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 400
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: reports/all-xtransformer-de.json
      hash: md5
      md5: 01301b5bda9a7c3e437abf35543fa784
      size: 94
  eval@tib-core-xtransformer-en:
    cmd:
    - annif eval -p projects-xtransformer.toml gnd-tib-core-xtransformer-en -j 1 -m
      F1@5 -m NDCG --metrics-file reports/tib-core-xtransformer-en.json shared-task-datasets/TIBKAT/tib-core-subjects/data/dev/en.tsv.gz
    deps:
    - path: data/projects/gnd-tib-core-xtransformer-en
      hash: md5
      md5: b87eec2e96ee2dc40b3729f1262d2630.dir
      size: 1230471627
      nfiles: 25
    - path: shared-task-datasets/TIBKAT/tib-core-subjects/data/dev/en.tsv.gz
      hash: md5
      md5: 708c23f77d00657e1607b0af74f204aa
      size: 3175639
    params:
      projects-xtransformer.toml:
        gnd-tib-core-xtransformer-en:
          name: GND-tib-core XTransformer English
          language: en
          backend: xtransformer
          analyzer: snowball(english)
          vocab: gnd-tib-core
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 400
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: reports/tib-core-xtransformer-en.json
      hash: md5
      md5: 16e242f3f0e6ba8dcd60b9a2b14164b1
      size: 93
