schema: '2.0'
stages:
  train-xtransformer@tib-core-en:
    cmd:
    - annif train -p projects-xtransformer.toml -j 32 gnd-tib-core-xtransformer-en
      shared-task-datasets/TIBKAT/tib-core-subjects/data/train/en.tsv.gz
    deps:
    - path: data/vocabs/gnd-tib-core
      hash: md5
      md5: 2c649e0e5842585f10bcb060a14a3ca8.dir
      size: 31870479
      nfiles: 3
    - path: shared-task-datasets/TIBKAT/tib-core-subjects/data/train/en.tsv.gz
      hash: md5
      md5: 6a8d0d989b1d9e2e5176becb6ed2f56e
      size: 19213009
    params:
      projects-xtransformer.toml:
        gnd-tib-core-xtransformer-en:
          name: GND-tib-core XTransformer English
          language: en
          backend: xtransformer
          analyzer: snowball(english)
          vocab: gnd-tib-core
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 18000
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: data/projects/gnd-tib-core-xtransformer-en
      hash: md5
      md5: 37d02895da3353dbedc2fece0d1838fc.dir
      size: 1226985595
      nfiles: 22
  train-xtransformer@tib-core-de:
    cmd:
    - annif train -p projects-xtransformer.toml -j 32 gnd-tib-core-xtransformer-de
      shared-task-datasets/TIBKAT/tib-core-subjects/data/train/de.tsv.gz
    deps:
    - path: data/vocabs/gnd-tib-core
      hash: md5
      md5: 2c649e0e5842585f10bcb060a14a3ca8.dir
      size: 31870479
      nfiles: 3
    - path: shared-task-datasets/TIBKAT/tib-core-subjects/data/train/de.tsv.gz
      hash: md5
      md5: 3f4d8a7c3f15e98bf433c6eef0f5295c
      size: 21140795
    params:
      projects-xtransformer.toml:
        gnd-tib-core-xtransformer-de:
          name: GND-tib-core XTransformer German
          language: de
          backend: xtransformer
          analyzer: snowball(german)
          vocab: gnd-tib-core
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 18000
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: data/projects/gnd-tib-core-xtransformer-de
      hash: md5
      md5: b9c79370cc4f75f2729662f71b6b2e29.dir
      size: 1245462758
      nfiles: 22
  train-xtransformer@all-de:
    cmd:
    - annif train -p projects-xtransformer.toml -j 32 gnd-all-xtransformer-de shared-task-datasets/TIBKAT/all-subjects/data/train/de.tsv.gz
    deps:
    - path: data/vocabs/gnd-all
      hash: md5
      md5: 1cbcfe7e8b91f19b3a72a5c0942862e7.dir
      size: 85564111
      nfiles: 3
    - path: shared-task-datasets/TIBKAT/all-subjects/data/train/de.tsv.gz
      hash: md5
      md5: 4e1a80f1e539d8e19073e004b752ead0
      size: 39773295
    params:
      projects-xtransformer.toml:
        gnd-all-xtransformer-de:
          name: GND-all XTransformer German
          language: de
          backend: xtransformer
          analyzer: snowball(german)
          vocab: gnd-all
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 18000
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: data/projects/gnd-all-xtransformer-de
      hash: md5
      md5: 3cf891fe07fb47089849ad7e5a198bff.dir
      size: 1354338573
      nfiles: 22
  train-xtransformer@all-en:
    cmd:
    - annif train -p projects-xtransformer.toml -j 32 gnd-all-xtransformer-en shared-task-datasets/TIBKAT/all-subjects/data/train/en.tsv.gz
    deps:
    - path: data/vocabs/gnd-all
      hash: md5
      md5: 1cbcfe7e8b91f19b3a72a5c0942862e7.dir
      size: 85564111
      nfiles: 3
    - path: shared-task-datasets/TIBKAT/all-subjects/data/train/en.tsv.gz
      hash: md5
      md5: 6444ce7a501bb62bcb9c7dded5722a87
      size: 36341593
    params:
      projects-xtransformer.toml:
        gnd-all-xtransformer-en:
          name: GND-all XTransformer English
          language: en
          backend: xtransformer
          analyzer: snowball(english)
          vocab: gnd-all
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 18000
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: data/projects/gnd-all-xtransformer-en
      hash: md5
      md5: 81513d05e6aa58efc0e82f28829c25f5.dir
      size: 1320565287
      nfiles: 22
  eval@all-xtransformer-en:
    cmd:
    - annif eval -p projects-xtransformer.toml gnd-all-xtransformer-en -j 1 -m F1@5
      -m NDCG --metrics-file reports/all-xtransformer-en.json shared-task-datasets/TIBKAT/all-subjects/data/dev/en.tsv.gz
    deps:
    - path: data/projects/gnd-all-xtransformer-en
      hash: md5
      md5: 81513d05e6aa58efc0e82f28829c25f5.dir
      size: 1320565287
      nfiles: 22
    - path: shared-task-datasets/TIBKAT/all-subjects/data/dev/en.tsv.gz
      hash: md5
      md5: cef663a3e160cba1eb960b5bbdf814bb
      size: 6045278
    params:
      projects-xtransformer.toml:
        gnd-all-xtransformer-en:
          name: GND-all XTransformer English
          language: en
          backend: xtransformer
          analyzer: snowball(english)
          vocab: gnd-all
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 18000
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: reports/all-xtransformer-en.json
      hash: md5
      md5: 51f14b9a42c98e50fc063f7ee4c2f26f
      size: 94
  eval@tib-core-xtransformer-de:
    cmd:
    - annif eval -p projects-xtransformer.toml gnd-tib-core-xtransformer-de -j 1 -m
      F1@5 -m NDCG --metrics-file reports/tib-core-xtransformer-de.json shared-task-datasets/TIBKAT/tib-core-subjects/data/dev/de.tsv.gz
    deps:
    - path: data/projects/gnd-tib-core-xtransformer-de
      hash: md5
      md5: b9c79370cc4f75f2729662f71b6b2e29.dir
      size: 1245462758
      nfiles: 22
    - path: shared-task-datasets/TIBKAT/tib-core-subjects/data/dev/de.tsv.gz
      hash: md5
      md5: 13bb3e235bf06cc40152b2d74a6cab52
      size: 3494814
    params:
      projects-xtransformer.toml:
        gnd-tib-core-xtransformer-de:
          name: GND-tib-core XTransformer German
          language: de
          backend: xtransformer
          analyzer: snowball(german)
          vocab: gnd-tib-core
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 18000
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: reports/tib-core-xtransformer-de.json
      hash: md5
      md5: 836ad3ed8920c7177df3a8e210ffedbb
      size: 92
  eval@all-xtransformer-de:
    cmd:
    - annif eval -p projects-xtransformer.toml gnd-all-xtransformer-de -j 1 -m F1@5
      -m NDCG --metrics-file reports/all-xtransformer-de.json shared-task-datasets/TIBKAT/all-subjects/data/dev/de.tsv.gz
    deps:
    - path: data/projects/gnd-all-xtransformer-de
      hash: md5
      md5: 3cf891fe07fb47089849ad7e5a198bff.dir
      size: 1354338573
      nfiles: 22
    - path: shared-task-datasets/TIBKAT/all-subjects/data/dev/de.tsv.gz
      hash: md5
      md5: 06f918e93fbd03fcb62e2e160eca06ba
      size: 6626372
    params:
      projects-xtransformer.toml:
        gnd-all-xtransformer-de:
          name: GND-all XTransformer German
          language: de
          backend: xtransformer
          analyzer: snowball(german)
          vocab: gnd-all
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 18000
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: reports/all-xtransformer-de.json
      hash: md5
      md5: 29e091e831fcc98a7b60ffa0f31e6153
      size: 95
  eval@tib-core-xtransformer-en:
    cmd:
    - annif eval -p projects-xtransformer.toml gnd-tib-core-xtransformer-en -j 1 -m
      F1@5 -m NDCG --metrics-file reports/tib-core-xtransformer-en.json shared-task-datasets/TIBKAT/tib-core-subjects/data/dev/en.tsv.gz
    deps:
    - path: data/projects/gnd-tib-core-xtransformer-en
      hash: md5
      md5: 37d02895da3353dbedc2fece0d1838fc.dir
      size: 1226985595
      nfiles: 22
    - path: shared-task-datasets/TIBKAT/tib-core-subjects/data/dev/en.tsv.gz
      hash: md5
      md5: 708c23f77d00657e1607b0af74f204aa
      size: 3175639
    params:
      projects-xtransformer.toml:
        gnd-tib-core-xtransformer-en:
          name: GND-tib-core XTransformer English
          language: en
          backend: xtransformer
          analyzer: snowball(english)
          vocab: gnd-tib-core
          batch_size: 16
          truncate_length: 256
          learning_rate: 0.0001
          num_train_epochs: 3
          max_leaf_size: 18000
          model_shortcut: FacebookAI/xlm-roberta-base
    outs:
    - path: reports/tib-core-xtransformer-en.json
      hash: md5
      md5: 894d9ae6b211f974e528f199dab12b28
      size: 94
